=== LLM PROMPT (Solution Generation) ===
Attempt: 4
Timestamp: 2025-11-26T00:32:05
Model: gpt-5
Workflow: gpt5_groq

====================================================================

You are a competitive programming expert.

**Problem: 2121_F**

You are given an array of integers a_1, a_2, ..., a_n and two integers s and x. Count the number of subsegments of the array whose sum of elements equals s and whose maximum value equals x.More formally, count the number of pairs 1 ≤q l ≤q r ≤q n such that: a_l + a_{l + 1} + ... + a_r = s. \max(a_l, a_{l + 1}, ..., a_r) = x.

**Previous Attempt Failed:** Time limit exceeded on test 15

**Task:** Please provide a corrected solution addressing the identified issues.

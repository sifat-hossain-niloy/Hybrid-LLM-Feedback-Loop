=== LLM PROMPT (Solution Generation) ===
Attempt: 2
Timestamp: 2025-11-26T04:29:06
Model: gpt-4
Workflow: gpt4_mistral

====================================================================

You are a competitive programming expert.

**Problem: 2121_F**

You are given an array of integers a_1, a_2, ..., a_n and two integers s and x. Count the number of subsegments of the array whose sum of elements equals s and whose maximum value equals x.More formally, count the number of pairs 1 ≤q l ≤q r ≤q n such that: a_l + a_{l + 1} + ... + a_r = s. \max(a_l, a_{l + 1}, ..., a_r) = x.

**Previous Attempt Failed:** Runtime error on test 4

**Task:** Please provide a corrected solution addressing the identified issues.

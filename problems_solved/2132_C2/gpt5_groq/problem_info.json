{
  "problem_id": "2132_C2",
  "contest_id": "2132",
  "letter": "C2",
  "title": "Problem 2132_C2",
  "statement": "This is the hard version of the problem. The easy version differs from the hard one in that it requires determining the minimum cost with the least number of deals, while the hard version requires determining the minimum cost with a limited number of deals.After the cunning seller sold three watermelons instead of one, he decided to increase his profit \u2014 namely, he bought even more watermelons. Now he can sell 3^x watermelons for 3^{x+1} + x \u00b7 3^{x-1} coins, where x is a non-negative integer. Su",
  "rating": "1400",
  "tags": [
    "binary search",
    "greedy",
    "math"
  ],
  "sample_tests": [
    {
      "input": "8\n1 1\n3 3\n8 3\n2 4\n10 10\n20 14\n3 2\n9 1",
      "output": "3\n9\n-1\n6\n30\n63\n10\n33"
    }
  ],
  "created_at": "2025-11-25T05:02:54"
}
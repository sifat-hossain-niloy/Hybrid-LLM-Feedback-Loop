{
    "statement": "Dedicated to pushing himself to his limits, Penchick challenged himself to survive the midday sun in the Arabian Desert!While trekking along a linear oasis, Penchick spots a desert rabbit preparing to jump along a line of palm trees. There are n trees, each with a height denoted by a_i.The rabbit can jump from the i-th tree to the j-th tree if exactly one of the following conditions is true: j < i and a_j > a_i: the rabbit can jump backward to a taller tree. j > i and a_j < a_i: the rabbit can jump forward to a shorter tree. For each i from 1 to n, determine the maximum height among all trees that the rabbit can reach if it starts from the i-th tree.",
    "input_specification": "InputThe first line contains the number of test cases t (1 ≤ t ≤ 5 · 10^5). The description of the test cases follows.The first line of each test case contains a single integer n (1 ≤q n ≤q 5 · 10^5) — the number of trees.The second line of each test case contains n integers a_1, a_2, ..., a_n (1 ≤ a_i ≤ n) — the height of the trees.It is guaranteed that the sum of n over all test cases does not exceed 5 · 10^5.",
    "output_specification": "OutputFor each test case, output n integers. The i-th integer should contain the maximum height among all trees that the rabbit can reach if it starts from the i-th tree.",
    "sample_tests": [
        {
            "input": "5\n4\n2 3 1 4\n5\n5 4 3 2 1\n4\n2 1 1 3\n4\n1 1 3 1\n8\n2 4 1 6 3 8 5 7",
            "output": "3 3 3 4 \n5 5 5 5 5 \n2 2 2 3 \n1 1 3 3 \n8 8 8 8 8 8 8 8"
        }
    ],
    "note": "In the first test case, the initial heights of trees are\na=[2,3,1,4]\n.\nIn the second test case, the rabbit can jump to the first tree regardless of which tree it starts from.\nIn the fifth test case, if the rabbit starts from the fifth tree, it can jump to the fourth tree. Then the rabbit can jump to the seventh tree and finally reach the sixth tree. Therefore, the maximum height of the tree that the rabbit can reach is\n8\n.",
    "tags": [
        "binary search",
        "data structures",
        "dfs and similar",
        "dp",
        "dsu",
        "greedy",
        "implementation",
        "two pointers"
    ],
    "rating": "1700"
}
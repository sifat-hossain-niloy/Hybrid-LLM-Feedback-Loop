{
    "statement": "Given a rooted tree with the root at vertex 1. For any vertex i (1 < i ≤q n) in the tree, there is an edge connecting vertices i and p_i (1 ≤q p_i < i), with a weight equal to t_i.Iris does not know the values of t_i, but she knows that \\displaystyle∑_{i=2}^n t_i = w and each of the t_i is a non-negative integer.The vertices of the tree are numbered in a special way: the numbers of the vertices in each subtree are consecutive integers. In other words, the vertices of the tree are numbered in the order of a depth-first search. The tree in this picture satisfies the condition. For example, in the subtree of vertex 2, the vertex numbers are 2, 3, 4, 5, which are consecutive integers. The tree in this picture does not satisfy the condition, as in the subtree of vertex 2, the vertex numbers 2 and 4 are not consecutive integers. We define \\operatorname{dist}(u, v) as the length of the simple path between vertices u and v in the tree.Next, there will be n - 1 events: Iris is given integers x and y, indicating that t_x = y. After each event, Iris wants to know the maximum possible value of \\operatorname{dist}(i, i \\bmod n + 1) independently for each i (1≤ i≤ n). She only needs to know the sum of these n values. Please help Iris quickly get the answers.Note that when calculating the maximum possible values of \\operatorname{dist}(i, i \\bmod n + 1) and \\operatorname{dist}(j, j \\bmod n + 1) for i ≠ j, the unknown edge weights may be different.",
    "input_specification": "InputEach test consists of multiple test cases. The first line contains a single integer t (1 ≤q t ≤q 10^4) — the number of test cases. The description of the test cases follows.The first line of each test case contains two integers n and w (2 ≤ n ≤ 2 · 10^5, 0 ≤q w ≤q 10^{12}) — the number of vertices in the tree and the sum of the edge weights.The second line of each test case contains n - 1 integers p_2, p_3, ..., p_n (1 ≤q p_i < i) — the description of the edges of the tree.Then follow n-1 lines indicating the events. Each line contains two integers x and y (2 ≤q x ≤q n, 0 ≤q y ≤q w), indicating that t_x = y.It is guaranteed that all x in the events are distinct. It is also guaranteed that the sum of all y equals w.It is guaranteed that the sum of n over all test cases does not exceed 2 · 10^5.",
    "output_specification": "OutputFor each test case, output one line containing n-1 integers, each representing the answer after each event.",
    "sample_tests": [
        {
            "input": "4\n2 1000000000000\n1\n2 1000000000000\n4 9\n1 1 1\n2 2\n4 4\n3 3\n6 100\n1 2 3 2 1\n6 17\n3 32\n2 4\n4 26\n5 21\n10 511\n1 2 2 4 2 1 1 8 8\n3 2\n6 16\n10 256\n9 128\n2 1\n5 8\n8 64\n4 4\n7 32",
            "output": "2000000000000\n25 18 18\n449 302 247 200 200\n4585 4473 2681 1567 1454 1322 1094 1022 1022"
        }
    ],
    "note": "In the first test case,\ndist(1,2)=dist(2,1)=t2=w=1012\n, so\ndist(1,2)+dist(2,1)=2⋅1012\n.\nIn the second test case, the tree after Iris found out all\ntx\nis shown below:\ndist(1,2)=t2\n,\ndist(2,3)=t2+t3\n,\ndist(3,4)=t3+t4\n,\ndist(4,1)=t4\n. After the first event, she found out that\nt2=2\n, so\ndist(1,2)=2\n. At the same time:\nThus, the answer is\n2+9+7+7=25\n.\nAfter the second event, she found out that\nt4=4\n, then\nt3=w−t2−t4=4\n.\ndist(1,2)=2\n,\ndist(2,3)=2+3=5\n,\ndist(3,4)=3+4=7\n,\ndist(4,1)=4\n. Thus, the answer is\n2+5+7+4=18\n.",
    "tags": [
        "brute force",
        "data structures",
        "dfs and similar",
        "dsu",
        "math",
        "trees"
    ],
    "rating": "1800"
}
{
    "statement": "Hello, Codeforces Forcescode! Kevin used to be a participant of Codeforces. Recently, the KDOI Team has developed a new Online Judge called Forcescode. Kevin has participated in n contests on Forcescode. In the i-th contest, his performance rating is a_i.Now he has hacked into the backend of Forcescode and will select an interval [l,r] (1≤ l≤ r≤ n), then skip all of the contests in this interval. After that, his rating will be recalculated in the following way: Initially, his rating is x=0; For each 1≤ i≤ n, after the i-th contest, If l≤ i≤ r, this contest will be skipped, and the rating will remain unchanged; Otherwise, his rating will be updated according to the following rules: If a_i>x, his rating x will increase by 1; If a_i=x, his rating x will remain unchanged; If a_i<x, his rating x will decrease by 1. You have to help Kevin to find his maximum possible rating after the recalculation if he chooses the interval [l,r] optimally. Note that Kevin has to skip at least one contest.",
    "input_specification": "InputEach test contains multiple test cases. The first line of the input contains a single integer t (1≤ t≤ 5· 10^4) — the number of test cases. The description of test cases follows.The first line of each test case contains a single integer n (1≤ n≤ 3· 10^5) — the number of contests.The second line contains n integers a_1,a_2,...,a_n (1≤ a_i≤ n) — the performance ratings in the contests.It is guaranteed that the sum of n over all test cases does not exceed 3 · 10^5.",
    "output_specification": "OutputFor each test case, output a single integer — the maximum possible rating after the recalculation if Kevin chooses the interval optimally.",
    "sample_tests": [
        {
            "input": "5\n6\n1 2 3 4 5 6\n7\n1 2 1 1 1 3 4\n1\n1\n9\n9 9 8 2 4 4 3 5 3\n10\n1 2 3 4 1 3 2 1 1 10",
            "output": "5\n4\n0\n4\n5"
        }
    ],
    "note": "In the first test case, Kevin must skip at least one contest. If he chooses any interval of length\n1\n, his rating after the recalculation will be equal to\n5\n.\nIn the second test case, Kevin's optimal choice is to select the interval\n[3,5]\n. During the recalculation, his rating changes as follows:\n0\na1=1\n→\n1\na2=2\n→\n2\nskip\n→\n2\nskip\n→\n2\nskip\n→\n2\na6=3\n→\n3\na7=4\n→\n4\nIn the third test case, Kevin must skip the only contest, so his rating will remain at the initial value of\n0\n.\nIn the fourth test case, Kevin's optimal choice is to select the interval\n[7,9]\n. During the recalculation, his rating changes as follows:\n0\na1=9\n→\n1\na2=9\n→\n2\na3=8\n→\n3\na4=2\n→\n2\na5=4\n→\n3\na6=4\n→\n4\nskip\n→\n4\nskip\n→\n4\nskip\n→\n4\nIn the fifth test case, Kevin's optimal choice is to select the interval\n[5,9]\n.",
    "tags": [
        "binary search",
        "data structures",
        "dp",
        "greedy"
    ],
    "rating": "1700"
}
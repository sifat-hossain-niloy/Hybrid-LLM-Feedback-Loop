{
    "statement": "Ecrade has an integer x. He will show you this number in the form of a binary number of length n.There are two kinds of operations. Replace x with â‰¤ft\\lfloor \\dfrac{x}{2}\\right\\rfloor, where â‰¤ft\\lfloor \\dfrac{x}{2}\\right\\rfloor is the greatest integer â‰¤ \\dfrac{x}{2}. Replace x with â‰¤ft\\lceil \\dfrac{x}{2}\\right\\rceil, where â‰¤ft\\lceil \\dfrac{x}{2}\\right\\rceil is the smallest integer â‰¥ \\dfrac{x}{2}. Ecrade will perform several operations until x becomes 1. Each time, he will independently choose to perform either the first operation or the second operation with probability \\frac{1}{2}.Ecrade wants to know the expected number of operations he will perform to make x equal to 1, modulo 10^9 + 7. However, it seems a little difficult, so please help him!",
    "input_specification": "InputThe first line contains a single integer t (1 â‰¤ t â‰¤ 10^5)Â â€” the number of test cases. The description of the test cases follows.The first line of each test case contains a single integer n (1 â‰¤ n â‰¤ 10^5)Â â€” the length of x in binary representation.The second line of each test case contains a binary string of length n: the number x in the binary representation, presented from the most significant bit to the least significant bit. It is guaranteed that the most significant bit of x is 1.It is guaranteed that the sum of n across all test cases does not exceed 10^5.",
    "output_specification": "OutputFor each test case, print a single integer representing the expected number of operations Ecrade will perform to make x equal to 1, modulo 10^9+7.Formally, let M = 10^9+7. It can be shown that the exact answer can be expressed as an irreducible fraction \\frac{p}{q}, where p and q are integers and q \\not â‰¡ 0 Â±od{M}. Output the integer equal to p Â· q^{-1} \\bmod M. In other words, output such an integer x that 0 â‰¤ x < M and x Â· q â‰¡ p Â±od{M}.",
    "sample_tests": [
        {
            "input": "3\n3\n110\n3\n100\n10\n1101001011",
            "output": "500000006\n2\n193359386"
        }
    ],
    "note": "For simplicity, we call the first operation\nOPER 1\nand the second operation\nOPER 2\n.\nIn the first test case,\nð‘¥=6\n, and there are six possible series of operations:\nThus, the expected number of operations is\n2â‹…\n1\n4\n+3â‹…\n1\n8\n+3â‹…\n1\n8\n+2â‹…\n1\n4\n+3â‹…\n1\n8\n+3â‹…\n1\n8\n=\n5\n2\nâ‰¡500000006(mod\n10\n9\n+7)\n.",
    "tags": [
        "bitmasks",
        "dp",
        "math",
        "probabilities"
    ],
    "rating": "1800"
}
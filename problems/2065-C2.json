{
    "statement": "This is the hard version of the problem. In this version, m ≤q 2· 10^5.Skibidus has obtained two arrays a and b, containing n and m elements respectively. For each integer i from 1 to n, he is allowed to perform the operation at most once: Choose an integer j such that 1 ≤q j ≤q m. Set a_i := b_j - a_i. Note that a_i may become non-positive as a result of this operation. Skibidus needs your help determining whether he can sort a in non-decreasing order^{\\text{∗}} by performing the above operation some number of times.^{\\text{∗}}a is sorted in non-decreasing order if a_1 ≤q a_2 ≤q ... ≤q a_n.",
    "input_specification": "InputThe first line contains an integer t (1 ≤q t ≤q 10^4) — the number of test cases.The first line of each test case contains two integers n and m (1 ≤q n ≤q 2 · 10^5, 1 ≤q m ≤q 2· 10^5).The following line of each test case contains n integers a_1, a_2, ..., a_n (1 ≤q a_i ≤q 10^9).The following line of each test case contains m integers b_1, b_2, ..., b_m (1 ≤q b_i ≤q 10^9).It is guaranteed that the sum of n and the sum of m over all test cases does not exceed 2 · 10^5.",
    "output_specification": "OutputFor each test case, if it is possible to sort a in non-decreasing order, print \"YES\" on a new line. Otherwise, print \"NO\" on a new line.You can output the answer in any case. For example, the strings \"yEs\", \"yes\", and \"Yes\" will also be recognized as positive responses.",
    "sample_tests": [
        {
            "input": "5\n1 3\n5\n9 1 1000000000\n3 2\n1 4 3\n3 4\n4 3\n2 4 6 5\n6 1 8\n5 2\n6 4 5 4 5\n4 1000\n3 1\n9 8 7\n8",
            "output": "YES\nNO\nYES\nNO\nYES"
        }
    ],
    "note": "In the first test case,\n[5]\nis already sorted.\nIn the second test case, it can be shown that it is impossible.\nIn the third test case, we can set\na2:=b1−a2=6−4=2\nand\na3:=b3−a3=8−6=2\n. The sequence\n[2,2,2,5]\nis in nondecreasing order.\nIn the last case, we can apply operations on each index. The sequence becomes\n[−1,0,1]\n, which is in nondecreasing order.",
    "tags": [
        "binary search",
        "greedy"
    ],
    "rating": "1300"
}
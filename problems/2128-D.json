{
    "statement": "You're given a permutation^{\\text{‚àó}} p_1, ..., p_n such that \\max(p_i, p_{i+1}) > p_{i+2} for all 1 ‚â§q i ‚â§q n-2.Compute the sum of the length of the longest decreasing subsequence^{\\text{‚Ä†}} of the subarray [p_l, p_{l+1}, ..., p_r] over all pairs 1 ‚â§q l ‚â§q r ‚â§q n.^{\\text{‚àó}}A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array). ^{\\text{‚Ä†}}Given an array b of size |b|, a decreasing subsequence of length k is a sequence of indices i_1, ..., i_k such that: 1 ‚â§q i_1 < i_2 < ... < i_k ‚â§q |b| b_{i_1} > b_{i_2} > ... > b_{i_k}",
    "input_specification": "InputEach test contains multiple test cases. The first line contains the number of test cases t (1 ‚â§ t ‚â§ 10\\,000). The description of the test cases follows. The first line of each test case contains a single integer n (3 ‚â§q n ‚â§q 500\\,000).The second line of each test case contains n integers p_1, p_2, ..., p_n (1 ‚â§ p_i ‚â§ n, p_i are pairwise distinct).It is guaranteed that \\max(p_i, p_{i+1}) > p_{i+2} for all 1 ‚â§q i ‚â§q n-2.The sum of n over all test cases does not exceed 500\\,000.",
    "output_specification": "OutputFor each test case, output the sum over all subarrays of the length of its longest decreasing subsequence.",
    "sample_tests": [
        {
            "input": "4\n3\n3 2 1\n4\n4 3 1 2\n6\n6 1 5 2 4 3\n3\n2 3 1",
            "output": "10\n17\n40\n8"
        }
    ],
    "note": "For any array\nùëé\n, we define\nLDS(ùëé)\nas the length of the longest decreasing subsequence of\nùëé\n.\nIn the first test case, all subarrays are decreasing.\nIn the second one, we have\nLDS([4])=LDS([3])=LDS([1])=LDS([2])=1\nLDS([4,3])=LDS([3,1])=2,LDS([1,2])=1\nLDS([4,3,1])=3,LDS([3,1,2])=2\nLDS([4,3,1,2])=3\nSo the answer is\n1+1+1+1+2+2+1+3+2+3=17\n.",
    "tags": [
        "brute force",
        "combinatorics",
        "dp",
        "greedy",
        "math"
    ],
    "rating": "1600"
}